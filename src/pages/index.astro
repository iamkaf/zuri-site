---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout title="Zuri | A small task app that lives in your system tray">
	<main class="container">
		<!-- Hero Section -->
		<section class="hero-section">
			<div class="animate-fade-up">
				<h1 class="hero-title">
					<span class="text-accent">Zuri.</span><br />
					Tasks in your tray.
				</h1>
				<p class="hero-subtitle">
					Not a whole productivity system.<br />
					Just a markdown file, a tray icon, and a shortcut. Open it, add
					a task, close it, move on.
				</p>

				<!-- OS Tabs -->
				<div
					class="os-tabs animate-fade-up delay-2"
					id="os-tabs"
					role="tablist"
				>
					<button
						class="os-tab active"
						role="tab"
						aria-selected="true"
						aria-controls="panel-linux"
						id="tab-linux"
						data-os="linux">Linux</button
					>
					<button
						class="os-tab"
						role="tab"
						aria-selected="false"
						aria-controls="panel-windows"
						id="tab-windows"
						data-os="windows">Windows</button
					>
					<button
						class="os-tab"
						role="tab"
						aria-selected="false"
						aria-controls="panel-macos"
						id="tab-macos"
						data-os="macos">macOS</button
					>
				</div>

				<!-- Install Blocks -->
				<div class="install-block-container animate-fade-up delay-2">
					<!-- Linux Panel -->
					<div
						class="install-block active"
						id="panel-linux"
						role="tabpanel"
						aria-labelledby="tab-linux"
					>
						<span class="prompt">$</span>
						<code class="install-code" id="install-cmd-linux"
							>curl -fsSL https://zuri.kaf.sh/install.sh | bash</code
						>
						<button
							class="copy-btn copy-action"
							aria-label="Copy install command"
							data-target="install-cmd-linux">Copy</button
						>
					</div>

					<!-- Windows Panel -->
					<div
						class="install-block"
						id="panel-windows"
						role="tabpanel"
						aria-labelledby="tab-windows"
						hidden
					>
						<span class="prompt">&gt;</span>
						<code class="install-code" id="install-cmd-windows"
							>irm https://zuri.kaf.sh/install.ps1 | iex</code
						>
						<button
							class="copy-btn copy-action"
							aria-label="Copy install command"
							data-target="install-cmd-windows">Copy</button
						>
					</div>

					<!-- macOS Panel -->
					<div
						class="install-block"
						id="panel-macos"
						role="tabpanel"
						aria-labelledby="tab-macos"
						hidden
					>
						<span class="prompt" style="color: var(--accent-color);"
							>â“˜</span
						>
						<span class="install-code"
							>Requires building from source on macOS</span
						>
						<a
							href="https://github.com/iamkaf/zuri/blob/main/docs/BUILDING_FROM_SOURCE.md"
							class="copy-btn cta-btn">Docs</a
						>
					</div>
				</div>

				<div
					class="animate-fade-up delay-3"
					style="margin-top: var(--space-md);"
				>
					<p class="mono text-secondary" style="font-size: 0.9rem;">
						Supports Linux, Windows, & macOS. <br />
						Requires Node.js 20+.
					</p>
				</div>
			</div>

			<!-- Abstract decor (Brutalist shape) -->
			<div class="decor-shape animate-fade-up delay-4"></div>
		</section>

		<!-- Philosophy -->
		<section class="section reveal" id="philosophy">
			<h2 style="font-size: clamp(2rem, 4vw, 3rem);">The Core Idea</h2>
			<div style="max-width: 800px;">
				<p
					style="font-size: 1.2rem; color: var(--text-secondary); margin-bottom: var(--space-md);"
				>
					Most task apps try to be your entire brain. Zuri doesn't.
					Zuri reads and writes <strong class="text-primary"
						>one markdown file</strong
					> that you control. You can edit it in your favorite text editor,
					and Zuri instantly reloads exactly what you saved.
				</p>

				<div class="code-example mono">
					<pre><code># Tasks

## Inbox
- [ ] Buy groceries
  - priority: P1
  - due: 2026-03-01
- [x] Call mom

## Habits
- [ ] Take vitamins
  - recur: daily
</code></pre>
				</div>
			</div>
		</section>

		<!-- Features -->
		<section class="section reveal" id="features">
			<h2>Features</h2>
			<div class="features-grid">
				<div class="feature-card">
					<h3 class="feature-title">Tray Native</h3>
					<p class="feature-desc">
						Click the tray icon to open. Click away to hide. It's
						always there when you need it, invisible when you don't.
					</p>
				</div>
				<div class="feature-card">
					<h3 class="feature-title">Plain Text Backed</h3>
					<p class="feature-desc">
						All tasks are stored in a standard Markdown file. No
						proprietary databases. Total ownership of your data.
					</p>
				</div>
				<div class="feature-card">
					<h3 class="feature-title">Global Shortcuts</h3>
					<p class="feature-desc">
						Hit your custom hotkey from anywhere in your OS to
						instantly bring up your task list and add a thought.
					</p>
				</div>
				<div class="feature-card">
					<h3 class="feature-title">Drag & Drop</h3>
					<p class="feature-desc">
						Reorder tasks instantly with native drag and drop. Built
						with @dnd-kit for a buttery smooth experience.
					</p>
				</div>
				<div class="feature-card">
					<h3 class="feature-title">Recurring Tasks</h3>
					<p class="feature-desc">
						Set tasks to recur daily, weekly, monthly, or on custom
						intervals directly via markdown tags.
					</p>
				</div>
				<div class="feature-card">
					<h3 class="feature-title">Open Source</h3>
					<p class="feature-desc">
						MIT Licensed. Inspect the code, tweak the UI, or build
						your own version. Built with React and Desktop web
						techs.
					</p>
				</div>
			</div>
		</section>

		<!-- Footer -->
		<footer class="footer reveal">
			<div>&copy; {new Date().getFullYear()} iamkaf</div>
			<div class="footer-links">
				<a href="https://github.com/iamkaf/zuri">GitHub Source</a>
				<a href="https://github.com/iamkaf/zuri/releases">Releases</a>
			</div>
		</footer>
	</main>

	<style>
		/* Scoped Styles for Index */
		.decor-shape {
			position: absolute;
			right: 5%;
			top: 50%;
			transform: translateY(-50%);
			width: 300px;
			height: 300px;
			background: var(--surface-color);
			border: 1px solid var(--accent-color);
			z-index: -1;
			clip-path: polygon(10% 0, 100% 20%, 90% 100%, 0 80%);
			opacity: 0.1;
			pointer-events: none;
		}

		/* OS Tabs */
		.os-tabs {
			display: flex;
			gap: 0;
			margin-bottom: -1px; /* Overlap border */
			z-index: 2;
			position: relative;
		}

		.os-tab {
			background: var(--bg-color);
			border: 1px solid var(--border-color);
			color: var(--text-secondary);
			padding: 0.5rem 1.5rem;
			font-family: var(--font-mono);
			font-size: 0.85rem;
			text-transform: uppercase;
			cursor: pointer;
			border-bottom-color: var(--border-color);
			transition: all 0.2s ease;
			border-radius: var(--radius-sm) var(--radius-sm) 0 0;
		}

		.os-tab:hover {
			color: var(--text-primary);
			background: var(--surface-color);
		}

		.os-tab.active {
			color: var(--accent-color);
			background: var(--surface-color);
			border-bottom-color: var(
				--surface-color
			); /* Merge visually with box below */
			font-weight: 700;
		}

		.install-block-container {
			position: relative;
		}

		/* Override global install-block for tabs */
		.install-block {
			display: none;
			align-items: center;
			gap: var(--space-md);
			background: var(--surface-color);
			border: 1px solid var(--border-color);
			border-radius: 0 var(--radius-md) var(--radius-md) var(--radius-md);
			padding: var(--space-sm) var(--space-md);
			font-family: var(--font-mono);
			position: relative;
			overflow: hidden;
		}

		.install-block.active {
			display: inline-flex;
		}

		.prompt {
			color: var(--text-secondary);
			user-select: none;
		}

		.cta-btn {
			text-decoration: none;
		}
		.cta-btn:hover {
			text-decoration: none;
			background: var(--accent-color);
			border-color: var(--accent-color);
			color: var(--bg-color);
		}

		@media (max-width: 768px) {
			.decor-shape {
				display: none;
			}
			.install-block-container {
				display: flex;
				flex-direction: column;
			}
			.install-block {
				flex-direction: column;
				align-items: stretch;
			}
			.hero-section {
				padding-top: var(--space-lg);
			}
			.os-tab {
				padding: 0.5rem 1rem;
				flex: 1;
				text-align: center;
			}
			.install-block {
				border-radius: 0 0 var(--radius-md) var(--radius-md);
			}
		}

		.code-example {
			background: #000;
			border: 1px solid var(--border-color);
			border-radius: var(--radius-md);
			padding: var(--space-sm) var(--space-md);
			overflow-x: auto;
			color: #a9b7c6;
		}

		.text-primary {
			color: var(--text-primary);
		}
	</style>

	<script>
		// Tab switching and auto-detect logic
		document.addEventListener("DOMContentLoaded", () => {
			const setOS = (os: string) => {
				// Deactivate all
				document.querySelectorAll(".os-tab").forEach((t) => {
					t.classList.remove("active");
					t.setAttribute("aria-selected", "false");
				});
				document.querySelectorAll(".install-block").forEach((p) => {
					p.classList.remove("active");
					(p as HTMLElement).hidden = true;
				});

				// Activate target
				const tab = document.querySelector(`.os-tab[data-os="${os}"]`);
				const panel = document.getElementById(`panel-${os}`);

				if (tab && panel) {
					tab.classList.add("active");
					tab.setAttribute("aria-selected", "true");
					panel.classList.add("active");
					panel.hidden = false;
				}
			};

			// Auto-detect OS
			const ua = navigator.userAgent.toLowerCase();
			let detectedOS = "linux";

			if (ua.indexOf("win") !== -1) {
				detectedOS = "windows";
			} else if (ua.indexOf("mac") !== -1) {
				detectedOS = "macos";
			}

			setOS(detectedOS);

			// Event listeners for tabs
			document.querySelectorAll(".os-tab").forEach((tab) => {
				tab.addEventListener("click", (e) => {
					const targetOS = (e.target as HTMLElement).getAttribute(
						"data-os"
					);
					if (targetOS) setOS(targetOS);
				});
			});

			// Copy to clipboard logic
			document.querySelectorAll(".copy-action").forEach((btn) => {
				btn.addEventListener("click", async (e) => {
					const btnEl = e.currentTarget as HTMLElement;
					const targetId = btnEl.getAttribute("data-target");
					if (!targetId) return;

					const installCmd = document.getElementById(targetId);
					if (!installCmd) return;

					try {
						await navigator.clipboard.writeText(
							installCmd.innerText
						);

						// Visual feedback
						const originalText = btnEl.innerText;
						btnEl.innerText = "Copied!";
						btnEl.classList.add("copied");

						setTimeout(() => {
							btnEl.innerText = originalText;
							btnEl.classList.remove("copied");
						}, 2000);
					} catch (err) {
						console.error("Failed to copy text: ", err);
						btnEl.innerText = "Error";
						setTimeout(() => {
							btnEl.innerText = "Copy";
						}, 2000);
					}
				});
			});
		});
	</script>
</BaseLayout>
